#ifndef __J_SHMEM_H__
#define __J_SHMEM_H__

#include <sys/shm.h>
#include <string.h>
#include <stdio.h>
#include "jlib.h"

//----------------------------------------------------------------------------------------------------------
// 共享内存结构体
//----------------------------------------------------------------------------------------------------------
struct jshmem_t
{
    unsigned short *uptr_shmem_addr;
    int v_shmem_id;
};

//----------------------------------------------------------------------------------------------------------
// 共享内存初始化
//----------------------------------------------------------------------------------------------------------
int j_shmem_init(struct jshmem_t *pjshmem, key_t v_i_key, size_t v_ul_size);

//----------------------------------------------------------------------------------------------------------
// 释放共享内存指针
//----------------------------------------------------------------------------------------------------------
int j_shmem_destroy(struct jshmem_t *pjshmem);

//----------------------------------------------------------------------------------------------------------
// 删除共享内存
//----------------------------------------------------------------------------------------------------------
int j_shmem_del(struct jshmem_t *pjshmem);

//----------------------------------------------------------------------------------------------------------
// 共享内存转无符号整型
//----------------------------------------------------------------------------------------------------------
unsigned short shm2ushort(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 共享内存转整型
//----------------------------------------------------------------------------------------------------------
short shm2short(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 共享内存转浮点数
//----------------------------------------------------------------------------------------------------------
float ushm2float(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 共享内存转浮点数
//----------------------------------------------------------------------------------------------------------
float shm2float(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 共享内存转浮点数(只除于10)
//----------------------------------------------------------------------------------------------------------
float shm2floatpid(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 共享内存转整数(只除于10)
//----------------------------------------------------------------------------------------------------------
short shm2shortpid(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 整数转共享内存（只乘于10）
//----------------------------------------------------------------------------------------------------------
short pidshm2short(unsigned short *shm_addr);

//----------------------------------------------------------------------------------------------------------
// 无符号整型转为共享内存
//----------------------------------------------------------------------------------------------------------
unsigned short ushort2shm(unsigned short us_data);

//----------------------------------------------------------------------------------------------------------
// 浮点数转为共享内存
//----------------------------------------------------------------------------------------------------------
unsigned short float2shm(float f_data);

//----------------------------------------------------------------------------------------------------------
// 双精度浮点数转为共享内存
//----------------------------------------------------------------------------------------------------------
void double2shm(unsigned short *addr, double data);

//----------------------------------------------------------------------------------------------------------
// 整型转为共享内存
//----------------------------------------------------------------------------------------------------------
unsigned short short2shm(short us_data);

//----------------------------------------------------------------------------------------------------------
// 共享内存转双精度浮点
//----------------------------------------------------------------------------------------------------------
double shm2double(unsigned short *shm_addr);



#endif